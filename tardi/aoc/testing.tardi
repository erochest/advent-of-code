uses: std/io
uses: std/strings
uses: std/vectors

// TODO: std/testing
// TODO: `tardi -m` to run a module
// TODO: find and run test files

// TODO: fail on symbol not found

// TODO: spec-test structures

// TODO: verbose flag to always print outcomes
// TODO: terminal coloring -- green and red
// TODO: set exit status
/// ? msg --
: test-output
    over [
        2drop
    ] [
        print
        ": " print
        .
    ] if ;

// TODO: how to abstract this out? maybe need assert!= and others
// TODO: take expected stack and a lambda. print lambda on failing
// TODO: print FAIL or SUCCESS
// TODO: print color
/// message expected actual ? --
: verbose-assert==
      [ [ >string ] bi@ ] dip   // >string
      [ print ] 3dip            // message
      ": " print
      [ print ] 2dip            // expected
      " == " " != " ? print     // ==/!=
      println ;                 // actual

: verbose-assert>
      [ [ >string ] bi@ ] dip   // >string
      [ print ] 3dip            // message
      ": " print
      [ print ] 2dip            // expected
      " > " " <= " ? print      // pass/fail
      println ;                 // actual

/// message actual expected ? --
: quiet-assert==
    [ 3drop ] [ #f verbose-assert== ] if ;

/// message actual expected --
: assert==   2dup == verbose-assert== ;
// : assert==   2dup == quiet-assert== ;

/// message actual expected-boundary --
: assert>   2dup > verbose-assert> ;

